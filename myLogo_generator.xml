<tool id="myLogo_generator" name="Peptide Logo plots" version="0.1.0" python_template_version="3.5">
    <requirements>
	<requirement type="package" version="3">python</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
	    python3 '$__tool_directory__/myLogo.py' 
	    -f #for $q in $InputType.series# '${q.input}' #end for#
	    -titles #for $q in $InputType.series# '${q.titles}' #end for#
	    -type $InputType.logoType 
	    -optionInput $InputType.optionInput	
	    -optionOut   $optionOut.optionPosOut
	    #if $optionOut.optionPosOut=="yes"
                -pos '$optionOut.pos'
            #end if

	]]></command>

    <inputs>

	<conditional name="InputType">
		<param type="select" name="optionInput" display="radio" label="Please select your input data type">
			<option value="peptide_list"> Peptides file (1st column should be peptides)</option>
			<option value="pssm_matrix"> PSSM matrix file (output from PSI-BLAST)</option>
		</param>

		<when value="peptide_list">
			<param name="logoType" type="select" display="radio"  label="Select the logo type:" >
				<option value="logo"> Logo</option>
				<option value="ice-logo"> Ice-logo</option>
			</param>

			<repeat name="series" title="Peptides files">
                		<param name="input" type="data" format="txt" label="Dataset" help="The input can be a matrix file, but the 1st column should be peptides"/>
                		<param name="titles" type="text" data_ref="input" label="Insert title of the plot if it is needed:"/>
        		</repeat>
		</when>


		<when value="pssm_matrix">
			<param name="logoType" type="select" display="radio"  label="Select the logo type:" >
				<option value="ice-logo"> Ice-logo</option>
			</param>

			<repeat name="series" title="PSSM matrix files">
                		<param name="input" type="data" format="txt" label="Dataset" help="The input should be the PSSM file from PsiBlast"/>
                		<param name="titles" type="text" data_ref="input" label="Name of the dataset"/>
			</repeat>

		</when>
	</conditional>


	<conditional name="optionOut">
              <param name="optionPosOut" type="select" display="radio" label="Do you want to ignore some positions?">
                    <option value="no"> No</option>
                    <option value="yes"> Yes</option>
              </param>
              <when value="yes">      
                    <param name="pos" type="text" value="" label="Please set your positions below" help="Note: position is written with whitespace, comma or semicolon as delimiters (all 3 or a mix of them work). e.g. 2;, 5,7;10 will be treated as 2,5,7,10"  />
              </when>
        </conditional>  


    </inputs>
    <outputs>
	<data name="output" format="pdf" from_work_dir="myLogo.pdf" label="Logo Plot"/>
    </outputs>
    <help><![CDATA[
        TODO: Fill in help.
    ]]></help>
</tool>
